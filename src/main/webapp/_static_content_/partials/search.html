<div class="container-fluid" ng-controller="NmdcSearchController as ctrl">

    <div class="col-sm-2">
        <div nmdc-error="ctrl.model.facets.error"></div>
        <div class="nmdc-facet" ng-repeat="facet in ctrl.model.facets">
            <h4>{{facet.name}} ({{facet.matches}})</h4>
            <div class="checkbox" ng-repeat="child in facet.children">
                <label>
                    <input type="checkbox" ng-model="child.selected" ng-change="ctrl.search()"> {{child.value}} ({{child.matches}})
                </label>
            </div>
        </div>
    </div>

    <div class="col-sm-2 col-sm-push-8">
        <h4>Geographical coverage</h4>

        <div nmdc-map id="nmdc-map"></div>
        <div class="checkbox">
            <label>
                <input type="checkbox" ng-model="ctrl.model.search.coverage.geographical.use"> Filter by
                <span ng-switch="ctrl.model.search.coverage.geographical.type">
                    <span ng-switch-when="rectangle">rectangle</span>
                    <span ng-switch-when="polygon">polygon</span>
                    <span ng-switch-default>map bounding box</span>
                </span>
            </label>
        </div>

        <h4>Temporal coverage</h4>

        <div class="form-horizontal">
            <div class="form-group">
                <label for="beginDate" class="col-sm-3 control-label">Begin</label>

                <div class="col-sm-9">
                    <input id="beginDate" class="form-control" type="text" ng-model="ctrl.model.search.coverage.temporal.beginDate">
                </div>
            </div>
            <div class="form-group">
                <label for="endDate" class="col-sm-3 control-label">End</label>

                <div class="col-sm-9">
                    <input id="endDate" class="form-control" type="text" ng-model="ctrl.model.search.coverage.temporal.endDate">
                </div>
            </div>
        </div>
        <div class="checkbox">
            <label>
                <input type="checkbox" ng-model="ctrl.model.search.coverage.temporal.use"> Filter by temporal coverage
            </label>
        </div>
    </div>

    <div class="col-sm-8 col-sm-pull-2">
        <div ng-hide="ctrl.model.ready">Loading configuration...</div>
        <form ng-submit="ctrl.search()">
            <div class="input-group">
                <input class="form-control" type="text" ng-blur="ctrl.search()" ng-model="ctrl.model.search.text">
                <span class="nmdc-clear glyphicon glyphicon-remove-circle" ng-click="ctrl.clearSearchText()"></span>
                <span class="input-group-btn">
                    <button class="btn btn-primary" type="submit">Search</button>
                </span>
            </div>
        </form>
        <div>
            <div ng-show="ctrl.isSearching" class="nmdc-searching">Searching...</div>
            <div nmdc-error="ctrl.model.search.error"></div>
            <div ng-show="ctrl.model.search.response.results">{{ctrl.model.search.response.matches}} data sets found</div>
            <div ng-repeat="item in ctrl.model.search.response.results">
                <h4>{{item.Entry_Title}}</h4>
                <div>{{item.Data_Summary}}</div>
                <div>
                    <a class="btn btn-info btn-xs" ng-href="#/details/{{item.Entry_ID}}">Details</a>
                    <a class="btn btn-info btn-xs" ng-hide="ctrl.model.basket.idToItem[item.Entry_ID]" href="" ng-click="ctrl.model.basket.add(item)">Add to basket</a>
                    <a class="btn btn-info btn-xs" ng-show="ctrl.model.basket.idToItem[item.Entry_ID]" href="" ng-click="ctrl.model.basket.remove(item)">Remove from basket</a>
                </div>
            </div>
            <pagination ng-show="ctrl.model.search.response.results" total-items="ctrl.model.search.response.matches" ng-model="ctrl.model.search.currentPage"
                        max-size="10" class="pagination-sm" boundary-links="true"></pagination>
        </div>
    </div>

</div>
